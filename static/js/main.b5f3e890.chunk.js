(this["webpackJsonptricaster-remote"]=this["webpackJsonptricaster-remote"]||[]).push([[0],{11:function(e,t,n){e.exports=n(19)},16:function(e,t,n){},18:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(9),i=n.n(c),o=(n(16),n(5)),s=n.n(o),l=n(10),u=n(6),m=n(1),d=n(2),v=n(4),h=n(3),p=(n(18),n(7)),f=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(e){var a,r;return Object(m.a)(this,n),(r=t.call(this,e)).state={value:null!==(a=e.ip)&&void 0!==a?a:"127.0.0.1",connecting:!1,success:!1,error:!1},r.handleChange=r.handleChange.bind(Object(p.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(p.a)(r)),r}return Object(d.a)(n,[{key:"handleChange",value:function(e){this.setState({value:e.target.value.trim()})}},{key:"handleSubmit",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),this.setState({connecting:!0,success:!1,error:!1}),e.next=4,b(this.state.value);case 4:n=e.sent,this.setState({connecting:!1}),null!==n?(this.props.onIPChange(this.state.value),this.setState({success:!0,info:n})):(console.error("No connection"),this.setState({error:!0}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("div",{className:"card-header-title"},"Einstellungen")),r.a.createElement("div",{className:"card-content"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-label is-normal"},r.a.createElement("label",{className:"label"},"IP/Hostname:")),r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"field has-addons"},r.a.createElement("p",{className:"control is-expanded"},r.a.createElement("input",{className:"input",type:"text",value:this.state.value,disabled:this.state.connecting,onChange:this.handleChange})),r.a.createElement("p",{className:"control"},r.a.createElement("button",{className:"button is-link",type:"submit",disabled:this.state.connecting},"Verbinden"))),this.state.success&&r.a.createElement("p",{className:"help is-success"},"Verbindung hergestellt"),this.state.error&&r.a.createElement("p",{className:"help is-danger"},"Verbindung konnte nicht hergestellt werden")))),this.state.connecting?r.a.createElement("div",{className:"field"},r.a.createElement("progress",{className:"progress is-small",max:"100"},"15%")):null,r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-label"}),r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},this.state.success&&r.a.createElement(g,{data:this.state.info}))))))))}}]),n}(r.a.Component);function g(e){var t,n,a;return r.a.createElement("div",{className:"columns is-mobile"},r.a.createElement("div",{className:"column is-one-quarter "},r.a.createElement("p",null,"Model:"),r.a.createElement("p",null,"Name:"),r.a.createElement("p",null,"Version:")),r.a.createElement("div",{className:"column"},r.a.createElement("p",null,null===(t=e.data)||void 0===t?void 0:t.model),r.a.createElement("p",null,null===(n=e.data)||void 0===n?void 0:n.name),r.a.createElement("p",null,null===(a=e.data)||void 0===a?void 0:a.version)))}function b(e){return E.apply(this,arguments)}function E(){return(E=Object(u.a)(s.a.mark((function e(t){var n,a,r,c,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://".concat(t,":5952/v1/version")).catch((function(e){return console.error(e),new Response(null,{status:404})}));case 2:if(!(n=e.sent).ok){e.next=14;break}return e.next=6,n.text();case 6:return a=e.sent,r=(new DOMParser).parseFromString(a,"text/xml"),c=r.getElementsByTagName("product_name")[0].innerHTML,i=r.getElementsByTagName("product_model")[0].innerHTML,o=r.getElementsByTagName("product_version")[0].innerHTML,e.abrupt("return",{model:i,name:c,version:o});case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(m.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={isExpanded:!1},e.toggleMenu=function(t){e.setState({isExpanded:!e.state.isExpanded}),t.preventDefault()},e}return Object(d.a)(n,[{key:"render",value:function(){var e;return e=this.state.isExpanded?" is-active":"",r.a.createElement("nav",{className:"navbar",role:"navigation","aria-label":"main navigation"},r.a.createElement("div",{className:"navbar-brand"},r.a.createElement("div",{className:"navbar-item"},"Tricaster Remote"),r.a.createElement("div",{role:"button",className:"navbar-burger"+e,"aria-label":"menu","aria-expanded":"false",onClick:this.toggleMenu},r.a.createElement("span",{"aria-hidden":"true"}),r.a.createElement("span",{"aria-hidden":"true"}),r.a.createElement("span",{"aria-hidden":"true"}))))}}]),n}(r.a.Component),w=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(m.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={connected:!1},e}return Object(d.a)(n,[{key:"render",value:function(){var e,t=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(N,null),r.a.createElement("div",{className:"modal"+(this.state.connected?"":" is-active")},r.a.createElement("div",{className:"modal-background"}),r.a.createElement("div",{className:"modal-content"},r.a.createElement(f,{onIPChange:function(e){console.log(e),t.setState({connected:!0,uri:e}),localStorage.setItem("ip",e)},ip:null!==(e=localStorage.getItem("ip"))&&void 0!==e?e:void 0}))),this.state.uri&&r.a.createElement("section",{className:"section"},r.a.createElement(k,{uri:this.state.uri})))}}]),n}(r.a.Component),y=function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(m.a)(this,e),this.name=t,this.index=n,this.pgm=a,this.prev=r},k=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(m.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={inputs:[]},e.ws=new WebSocket("ws://".concat(e.props.uri,":5951/v1/change_notifications")),e.connectWebsocket=function(){e.ws.onclose=e.connectWebsocket,e.ws.onopen=function(){console.debug("TriCaster WebSocket Opened")},e.ws.onmessage=function(t){"tally"===t.data?e.getTally():"switcher"===t.data||t.data}},e.getTally=Object(u.a)(s.a.mark((function t(){var n,a,r,c,i,o,u,m,d,v,h;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://".concat(e.props.uri,":5952/v1/dictionary?key=tally"));case 2:return n=t.sent,t.next=5,n.text();case 5:a=t.sent,console.group("Parse Tally"),console.debug("raw: %o",a),r=(new DOMParser).parseFromString(a,"text/xml"),console.debug("parsed: %o",r),c=r.getElementsByTagName("column"),i=[],o=Object(l.a)(c);try{for(o.s();!(u=o.n()).done;)d=u.value,(null===(m=d.getAttribute("name"))||void 0===m?void 0:m.startsWith("input"))&&i.push(new y(null!==(v=d.getAttribute("name"))&&void 0!==v?v:"",+(null!==(h=d.getAttribute("index"))&&void 0!==h?h:""),"true"===d.getAttribute("on_pgm"),"true"===d.getAttribute("on_prev")))}catch(s){o.e(s)}finally{o.f()}console.debug("inputs: %o",i),e.setState({inputs:i}),console.groupEnd();case 17:case"end":return t.stop()}}),t)}))),e.sendShortcut=function(t){fetch("http://".concat(e.props.uri,":5952/v1/shortcut?").concat(t)).then((function(e){return console.debug(e)}))},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.connectWebsocket(),this.getTally()}},{key:"componentWillUnmount",value:function(){this.ws.close()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(x,{label:"Pgm",className:"pgm",onAction:this.sendShortcut,actionName:"main_a_row",inputs:this.state.inputs,isButtonActive:function(e){return e.pgm}}),r.a.createElement(x,{label:"Prev",className:"prev",onAction:this.sendShortcut,actionName:"main_b_row",inputs:this.state.inputs,isButtonActive:function(e){return e.prev}}),r.a.createElement(O,{onAction:this.sendShortcut}))}}]),n}(r.a.Component),O=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{marginTop:"1em"}},r.a.createElement(j,{label:"AUTO",onClick:function(){return e.props.onAction("name=main_auto")}}),r.a.createElement(j,{label:"TAKE",onClick:function(){return e.props.onAction("name=main_take")}}))}}]),n}(r.a.Component);function j(e){var t="button"+(e.active?" is-active":"");return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:t,onClick:e.onClick},e.label))}function x(e){var t=e.inputs.map((function(t){return r.a.createElement(j,{label:t.index+1+"",active:e.isButtonActive(t),key:t.name,onClick:function(){return e.onAction("name=".concat(e.actionName,"&value=").concat(t.index))}})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:e.className},r.a.createElement("div",null,e.label),t))}var S=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function A(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(w,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/tricaster-remote",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/tricaster-remote","/service-worker.js");S?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):A(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):A(t,e)}))}}()}},[[11,1,2]]]);
//# sourceMappingURL=main.b5f3e890.chunk.js.map